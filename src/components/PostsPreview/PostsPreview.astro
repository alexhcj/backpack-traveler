---
import PostPreviewItem from "./PostPreviewItem.astro";
import type { Post } from "../../types/post";
const posts = await Astro.glob<Post>("../../pages/posts/*.md");
const postsPreview = [
    "village-in-the-brazil",
    "top-10-popular-sports-on-the-world",
    "eating-food-tour",
    "venice-city-tour-with-river-cruise",
    "the-15-best-things-to-do-in-dublin",
    "the-worldâ€™s-best-drinking",
    "explore-the-finest-beaches-in-italy",
    "the-essential-paris-travel-guide-and-map",
    "traveler-who-walks-around",
    "a-guide-for-budget-travel-with-pets",
];
const postsList = posts.filter((post) =>
    postsPreview.some((slug: string) => post.frontmatter.slug === slug),
);
import ArrowSVG from "../../../public/svg/arrow.svg";
---

<section>
    <div class="wrapper">
        <ul id="hero-slider" class="keen-slider">
            {
                postsList.map((post, index) => (
                    <li class={`keen-slider__slide number-slide${index}`}>
                        <PostPreviewItem
                            title={post.frontmatter.title}
                            url={post.frontmatter.image.url}
                            alt={post.frontmatter.image.alt}
                            destination={post.frontmatter.destination}
                            category={post.frontmatter.category}
                            slug={post.frontmatter.slug}
                        />
                    </li>
                ))
            }
        </ul>
        <div class="controls" data-controls>
            <button
                class="control prev"
                role="presentation"
                type="button"
                data-control="prev"
            >
                <img src={ArrowSVG.src} alt="Previous slide" />
            </button>
            <button
                class="control next"
                role="presentation"
                type="button"
                data-control="next"
            >
                <img src={ArrowSVG.src} alt="Next slide" />
            </button>
        </div>
    </div>
</section>

<style>
    section {
        padding-bottom: 100px;
    }
    .wrapper {
        padding: 0 40px;
        position: relative;
    }
    .control {
        position: absolute;
        top: 200px;
        width: 62px;
        height: 47px;
        padding: 10px;
        background-color: var(--color-white);
        cursor: pointer;

        &.prev {
            left: 0;
        }

        &.next {
            right: 0;

            img {
                transform: scaleX(-1);
            }
        }
    }
</style>

<script>
    import "keen-slider/keen-slider.min.css";
    import KeenSlider from "keen-slider";

    const slider = new KeenSlider("#hero-slider", {
        loop: true,
        drag: true,
        slides: {
            perView: 5,
            spacing: 10,
        },
    });

    const handleSliderControls = (control: any) => {
        control.target.getAttribute("data-control") === "next"
            ? slider.next()
            : slider.prev();
    };

    const controls = document.querySelector("[data-controls]")!;

    controls.addEventListener("click", (e: any) => handleSliderControls(e));
</script>
